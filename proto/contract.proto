syntax = "proto3";
package luckyComet55.marzban_mgmt;

import "google/protobuf/empty.proto";

option go_package = "github.com/luckyComet55/marzban-proto-contract/gen/go/contract";

service MarzbanManagementPanel {

    rpc ListUsers (google.protobuf.Empty) returns (stream UserShortInfo) {}
    rpc CreateUser (CreateUserInfo) returns (UserInfo) {}
    rpc ListProxies (google.protobuf.Empty) returns (stream ProxyProtocolInfo) {}
    rpc GetUser (UserShortInfo) returns (UserInfo) {}
}

enum ProxyProtocolType {
    VMESS = 0;
    VLESS = 1;
    TROJAN = 2;
    SHADOWSOCKS = 3;
}

message ProxyProtocolInfo {
    string proxy_name = 1;
    ProxyProtocolType protocol_type = 2;
}

message UserShortInfo {
    string username = 1;
}

message UserInfo {
    string username = 1;
    string status = 2;
    uint64 used_traffic = 3;
    repeated string config_urls = 4;
    repeated ProxyProtocolInfo proxy_protocol = 5;
}

message CreateUserInfo {
    string username = 1;
    string proxy_protocol = 2;
}
